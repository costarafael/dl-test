import{r as h,j as e,f as c,T as V,c as G,h as N,g as a,B as i}from"./index-DOaqLF5S.js";import{C as k}from"./Card-Czmt41UV.js";import{u as j,m as J,n as K,a as O,t as Q,e as U}from"./format-G53zHD2b.js";import{f as S}from"./dateHelpers-C52cMW5X.js";import{N as W}from"./NewMovementModal-DcOUhh5s.js";import{a as X}from"./entityHelpers-BKFEPAjO.js";import{F as Y}from"./MagnifyingGlassIcon-B7c_-jcv.js";import{F as T}from"./EyeIcon-CDoVhD-a.js";import{F as H}from"./PencilIcon-CBsE5zi0.js";const ce=()=>{const[n,I]=h.useState("entradas"),[t,P]=h.useState(""),[o,E]=h.useState("todos"),[A,v]=h.useState(!1),{data:r=[],loading:F,refetch:R}=j(K.getAll),{data:d=[],loading:M,refetch:$}=j(O.getAll),{data:z=[],loading:B}=j(Q.getAll),{data:D=[]}=j(U.getAll),u=F||M||B,x=(n==="entradas"?r||[]:d||[]).filter(s=>{var C,b,y;const l=t===""||((C=s.numeroNota)==null?void 0:C.toLowerCase().includes(t.toLowerCase()))||((b=s.responsavel)==null?void 0:b.toLowerCase().includes(t.toLowerCase()))||((y=s.motivo)==null?void 0:y.toLowerCase().includes(t.toLowerCase())),g=o==="todos"||s.status===o;return l&&g}),p=s=>{switch(s){case"pendente":return e.jsx(i,{color:"warning",className:"w-fit",children:"Pendente"});case"processada":return e.jsx(i,{color:"success",className:"w-fit",children:"Processada"});case"cancelada":return e.jsx(i,{color:"failure",className:"w-fit",children:"Cancelada"});default:return e.jsx(i,{color:"gray",className:"w-fit",children:s})}},L=async s=>{try{await J.criarMovimentacao(s),s.tipo==="entrada"?await R():await $()}catch(l){throw console.error("Erro ao criar movimentação:",l),l}},f=s=>{console.log("Edit note:",s)},w=s=>{console.log("View note:",s)},q=s=>"valorTotal"in s&&s.valorTotal?`R$ ${s.valorTotal.toFixed(2)}`:"-",m=s=>s.itens.reduce((l,g)=>l+g.quantidade,0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 dark:text-white",children:"Movimentações de Estoque"}),e.jsxs(c,{onClick:()=>v(!0),color:"primary",size:"sm",className:"rounded-sm",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Nova Movimentação"]})]}),e.jsx(k,{className:"rounded-sm",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Buscar"}),e.jsx("div",{className:"relative",children:e.jsx(V,{icon:Y,placeholder:"Buscar por número, responsável ou motivo...",value:t,onChange:s=>P(s.target.value),sizing:"sm",className:"rounded-sm"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Status"}),e.jsxs(G,{value:o,onChange:s=>E(s.target.value),sizing:"sm",className:"rounded-sm",children:[e.jsx("option",{value:"todos",children:"Todos os status"}),e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"processada",children:"Processada"}),e.jsx("option",{value:"cancelada",children:"Cancelada"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.jsx("span",{className:"font-medium",children:x.length})," registro(s) encontrado(s)"]})})]})}),e.jsx(k,{className:"rounded-sm",children:e.jsxs(N.Group,{style:"underline",onActiveTabChange:s=>I(s===0?"entradas":"saidas"),children:[e.jsx(N.Item,{title:`Notas de Entrada (${(r||[]).length})`,active:n==="entradas",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-green-600 dark:text-green-400",children:"Total Processadas"}),e.jsx("div",{className:"text-xl font-semibold text-green-700 dark:text-green-300",children:(r||[]).filter(s=>s.status==="processada").length})]}),e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"Pendentes"}),e.jsx("div",{className:"text-xl font-semibold text-yellow-700 dark:text-yellow-300",children:(r||[]).filter(s=>s.status==="pendente").length})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Valor Total"}),e.jsxs("div",{className:"text-xl font-semibold text-blue-700 dark:text-blue-300",children:["R$ ",(r||[]).filter(s=>s.status==="processada").reduce((s,l)=>s+(l.valorTotal||0),0).toFixed(2)]})]}),e.jsxs("div",{className:"bg-purple-50 dark:bg-purple-900/20 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-purple-600 dark:text-purple-400",children:"Itens Recebidos"}),e.jsxs("div",{className:"text-xl font-semibold text-purple-700 dark:text-purple-300",children:[(r||[]).filter(s=>s.status==="processada").reduce((s,l)=>s+m(l),0)," un."]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(a,{children:[e.jsxs(a.Head,{children:[e.jsx(a.HeadCell,{children:"Número da Nota"}),e.jsx(a.HeadCell,{children:"Data"}),e.jsx(a.HeadCell,{children:"Responsável"}),e.jsx(a.HeadCell,{children:"Fornecedor"}),e.jsx(a.HeadCell,{children:"Valor Total"}),e.jsx(a.HeadCell,{children:"Itens"}),e.jsx(a.HeadCell,{children:"Status"}),e.jsx(a.HeadCell,{children:"Ações"})]}),e.jsx(a.Body,{children:x.map(s=>e.jsxs(a.Row,{children:[e.jsx(a.Cell,{className:"font-medium",children:s.numeroNota}),e.jsx(a.Cell,{children:S(s.data)}),e.jsx(a.Cell,{children:s.responsavel}),e.jsx(a.Cell,{children:"fornecedor"in s&&s.fornecedor||"-"}),e.jsx(a.Cell,{children:q(s)}),e.jsx(a.Cell,{children:e.jsxs(i,{color:"blue",className:"w-fit",children:[m(s)," un."]})}),e.jsx(a.Cell,{children:p(s.status)}),e.jsx(a.Cell,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(c,{onClick:()=>w(s),color:"gray",size:"xs",className:"rounded-sm",children:e.jsx(T,{className:"h-4 w-4"})}),e.jsx(c,{onClick:()=>f(s),color:"primary",size:"xs",className:"rounded-sm",disabled:s.status==="cancelada",children:e.jsx(H,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})}),e.jsx(N.Item,{title:`Notas de Saída (${(d||[]).length})`,active:n==="saidas",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-red-600 dark:text-red-400",children:"Total Processadas"}),e.jsx("div",{className:"text-xl font-semibold text-red-700 dark:text-red-300",children:(d||[]).filter(s=>s.status==="processada").length})]}),e.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-yellow-600 dark:text-yellow-400",children:"Pendentes"}),e.jsx("div",{className:"text-xl font-semibold text-yellow-700 dark:text-yellow-300",children:(d||[]).filter(s=>s.status==="pendente").length})]}),e.jsxs("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-orange-600 dark:text-orange-400",children:"Itens Expedidos"}),e.jsxs("div",{className:"text-xl font-semibold text-orange-700 dark:text-orange-300",children:[(d||[]).filter(s=>s.status==="processada").reduce((s,l)=>s+m(l),0)," un."]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Destinatários"}),e.jsx("div",{className:"text-xl font-semibold text-gray-700 dark:text-gray-300",children:new Set((d||[]).filter(s=>"destinatario"in s&&s.destinatario).map(s=>"destinatario"in s?s.destinatario:"")).size})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(a,{children:[e.jsxs(a.Head,{children:[e.jsx(a.HeadCell,{children:"Número da Nota"}),e.jsx(a.HeadCell,{children:"Data"}),e.jsx(a.HeadCell,{children:"Responsável"}),e.jsx(a.HeadCell,{children:"Destinatário"}),e.jsx(a.HeadCell,{children:"Solicitante"}),e.jsx(a.HeadCell,{children:"Itens"}),e.jsx(a.HeadCell,{children:"Status"}),e.jsx(a.HeadCell,{children:"Ações"})]}),e.jsx(a.Body,{children:x.map(s=>e.jsxs(a.Row,{children:[e.jsx(a.Cell,{className:"font-medium",children:s.numeroNota}),e.jsx(a.Cell,{children:S(s.data)}),e.jsx(a.Cell,{children:s.responsavel}),e.jsx(a.Cell,{children:"destinatario"in s&&s.destinatario||"-"}),e.jsx(a.Cell,{children:"solicitante"in s&&s.solicitante||"-"}),e.jsx(a.Cell,{children:e.jsxs(i,{color:"blue",className:"w-fit",children:[m(s)," un."]})}),e.jsx(a.Cell,{children:p(s.status)}),e.jsx(a.Cell,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(c,{onClick:()=>w(s),color:"gray",size:"xs",className:"rounded-sm",children:e.jsx(T,{className:"h-4 w-4"})}),e.jsx(c,{onClick:()=>f(s),color:"primary",size:"xs",className:"rounded-sm",disabled:s.status==="cancelada",children:e.jsx(H,{className:"h-4 w-4"})})]})})]},s.id))})]})})]})})]})}),e.jsx(W,{show:A,onClose:()=>v(!1),onSave:L,tiposEPI:z,estoque:D,isLoading:u}),u&&e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:"Carregando movimentações..."})}),!u&&x.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:t||o!=="todos"?"Nenhuma movimentação encontrada com os filtros aplicados.":`Nenhuma nota de ${n==="entradas"?"entrada":"saída"} cadastrada.`})})]})};export{ce as default};
//# sourceMappingURL=MovimentacoesEstoque-urctORaJ.js.map
