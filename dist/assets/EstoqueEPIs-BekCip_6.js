const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/format-G53zHD2b.js","assets/index-DOaqLF5S.js","assets/index-B1zjWaTr.css"])))=>i.map(i=>d[i]);
import{r as m,j as e,a as oe,L as b,T as k,f as y,g as u,B as _,c as le,d as ne,M as f,u as de,D as R,P as ie,_ as ce}from"./index-DOaqLF5S.js";import{F as V}from"./ChartBarIcon-BG6Ly700.js";import{F as H}from"./ClockIcon-DYlY5-KA.js";import{S as B,a as me,F as xe}from"./SearchableDropdown-BGqvdnH0.js";import{calcularStatusEstoque as I,isProximoVencimento as ue}from"./estoqueHelpers-D6sB3H2E.js";import{f as Q}from"./dateHelpers-C52cMW5X.js";import{h as he,e as F,u as D,t as ge}from"./format-G53zHD2b.js";import{N as je}from"./NewMovementModal-DcOUhh5s.js";import{c as ve}from"./entityHelpers-BKFEPAjO.js";import{F as pe}from"./ClipboardDocumentListIcon-DCDswLyp.js";import{F as ye}from"./ArrowDownTrayIcon-BeJoba6h.js";import"./MagnifyingGlassIcon-B7c_-jcv.js";function Ne({title:a,titleId:l,...t},o){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":l},t),a?m.createElement("title",{id:l},a):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M10.5 6h9.75M10.5 6a1.5 1.5 0 1 1-3 0m3 0a1.5 1.5 0 1 0-3 0M3.75 6H7.5m3 12h9.75m-9.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-3.75 0H7.5m9-6h3.75m-3.75 0a1.5 1.5 0 0 1-3 0m3 0a1.5 1.5 0 0 0-3 0m-9.75 0h9.75"}))}const be=m.forwardRef(Ne);function fe({title:a,titleId:l,...t},o){return m.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":l},t),a?m.createElement("title",{id:l},a):null,m.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5"}))}const we=m.forwardRef(fe),ke=({stats:a})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-600 dark:text-blue-400",children:"Total de Itens"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700 dark:text-blue-300",children:a.totalItens})]}),e.jsx(V,{className:"w-8 h-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-green-50 dark:bg-green-900/20 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Disponível"}),e.jsx("p",{className:"text-2xl font-bold text-green-700 dark:text-green-300",children:a.totalDisponivel})]}),e.jsx(V,{className:"w-8 h-8 text-green-500"})]})}),e.jsx("div",{className:"bg-orange-50 dark:bg-orange-900/20 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-orange-600 dark:text-orange-400",children:"Estoque Baixo"}),e.jsx("p",{className:"text-2xl font-bold text-orange-700 dark:text-orange-300",children:a.estoqueMinimo})]}),e.jsx(oe,{className:"w-8 h-8 text-orange-500"})]})}),e.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:"Próx. Vencimento"}),e.jsx("p",{className:"text-2xl font-bold text-red-700 dark:text-red-300",children:a.proximoVencimento})]}),e.jsx(H,{className:"w-8 h-8 text-red-500"})]})})]}),Me=[{value:"disponivel",label:"Disponível"},{value:"baixo",label:"Estoque baixo"},{value:"vencendo",label:"Próximo ao vencimento"},{value:"vencido",label:"Vencido"}],Ce=({searchTerm:a,setSearchTerm:l,filtroStatus:t,setFiltroStatus:o,filtroLocalizacao:s,setFiltroLocalizacao:n,localizacoes:x})=>e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between space-y-3 md:space-y-0 md:space-x-4 p-4 border-t dark:border-gray-700",children:[e.jsxs("div",{className:"w-full md:w-1/3",children:[e.jsx(b,{htmlFor:"table-search",className:"sr-only",children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:e.jsx("svg",{className:"w-4 h-4 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"})})}),e.jsx(k,{id:"table-search",placeholder:"Buscar por equipamento, CA ou localização...",value:a,onChange:c=>l(c.target.value),sizing:"sm",className:"pl-10 rounded-sm"})]})]}),e.jsxs("div",{className:"w-full md:w-auto flex flex-col md:flex-row space-y-2 md:space-y-0 items-stretch md:items-center justify-end md:space-x-3 flex-shrink-0",children:[e.jsx(B,{options:Me,value:t,onChange:o,placeholder:"Selecionar status...",searchPlaceholder:"Buscar status...",allOptionsLabel:"Todos os status",sizing:"sm"}),e.jsx(B,{options:x.map(c=>({value:c,label:c})),value:s,onChange:n,placeholder:"Selecionar localização...",searchPlaceholder:"Buscar localizações...",allOptionsLabel:"Todas as localizações",sizing:"sm"}),e.jsxs(y,{color:"light",sizing:"xs",className:"rounded-sm",children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Filtros"]})]})]}),Ie=a=>{switch(a){case"disponivel":return{color:"green",label:"Disponível"};case"baixo":return{color:"yellow",label:"Estoque baixo"};case"vencendo":return{color:"orange",label:"Próximo ao vencimento"};case"vencido":return{color:"red",label:"Vencido"};default:return{color:"gray",label:"Indefinido"}}},Fe=({itens:a,getTipoEPI:l,onAjuste:t,onHistorico:o})=>e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(u,{hoverable:!0,className:"min-w-full",children:[e.jsxs(u.Head,{children:[e.jsx(u.HeadCell,{children:"Equipamento"}),e.jsx(u.HeadCell,{children:"Localização"}),e.jsx(u.HeadCell,{children:"Lote"}),e.jsx(u.HeadCell,{children:"Quantidade"}),e.jsx(u.HeadCell,{children:"Status"}),e.jsx(u.HeadCell,{children:"Validade"}),e.jsx(u.HeadCell,{className:"w-32",children:e.jsx("span",{className:"sr-only",children:"Ações"})})]}),e.jsx(u.Body,{className:"divide-y",children:a.length>0?a.map(s=>{const n=l(s.tipoEPIId),x=I(s),c=Ie(x),r=ue(s);return e.jsxs(u.Row,{className:"bg-white dark:border-gray-700 dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-600",children:[e.jsx(u.Cell,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-white",children:n==null?void 0:n.nomeEquipamento}),e.jsxs("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:["CA ",n==null?void 0:n.numeroCA," • ",n==null?void 0:n.fabricante]})]})}),e.jsx(u.Cell,{children:e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:s.localizacao})}),e.jsx(u.Cell,{children:e.jsx("div",{className:"text-sm text-gray-900 dark:text-white",children:s.lote})}),e.jsx(u.Cell,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"font-medium text-gray-900 dark:text-white",children:s.quantidade}),e.jsx("span",{className:"ml-1 text-sm text-gray-500 dark:text-gray-400",children:"un."})]})}),e.jsx(u.Cell,{children:e.jsx(_,{color:c.color,size:"sm",className:"w-fit",children:c.label})}),e.jsx(u.Cell,{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-sm text-gray-900 dark:text-white",children:Q(s.dataValidade)}),r&&e.jsx(H,{className:"w-4 h-4 ml-2 text-orange-500",title:"Próximo ao vencimento"})]})}),e.jsx(u.Cell,{children:e.jsxs("div",{className:"flex space-x-1",children:[e.jsx(y,{sizing:"xs",color:"gray",onClick:()=>t(s),title:"Ajustar quantidade",className:"rounded-sm",children:e.jsx(be,{className:"w-4 h-4"})}),e.jsx(y,{sizing:"xs",color:"light",onClick:()=>o(s),title:"Ver histórico",className:"rounded-sm",children:e.jsx(H,{className:"w-4 h-4"})})]})})]},s.id)}):e.jsx(u.Row,{children:e.jsx(u.Cell,{colSpan:7,className:"text-center py-8",children:e.jsxs("div",{className:"flex flex-col items-center justify-center",children:[e.jsx("svg",{className:"w-12 h-12 text-gray-400 mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-4m-12 0H4m16 0H4"})}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhum item encontrado"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-2",children:"Ajuste os filtros ou adicione novos itens ao estoque"})]})})})})]})}),qe=["Compra","Doação","Transferência","Devolução","Ajuste de inventário","Outros"],ze=["Entrega ao colaborador","Transferência","Descarte por vencimento","Descarte por avaria","Perda","Outros"],Se=["Contagem física","Correção de erro","Avaria detectada","Atualização do sistema","Outros"],Ae=({tipo:a,formData:l,onChange:t,currentStock:o,disabled:s=!1})=>{const n=()=>{switch(a){case"entrada":return qe;case"saida":return ze;case"ajuste":return Se;default:return[]}},x=()=>{switch(a){case"entrada":return"Quantidade a adicionar";case"saida":return"Quantidade a retirar";case"ajuste":return"Nova quantidade total";default:return"Quantidade"}},c=()=>a==="saida"?o:void 0;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"quantidade",className:"text-gray-700 dark:text-gray-300 mb-2 block",children:[x()," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(k,{id:"quantidade",type:"number",min:"1",max:c(),value:l.quantidade,onChange:r=>t("quantidade",parseInt(r.target.value)||0),placeholder:"Digite a quantidade",sizing:"sm",className:"rounded-sm",required:!0,disabled:s}),a==="saida"&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Máximo disponível: ",o," unidades"]})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"responsavel",className:"text-gray-700 dark:text-gray-300 mb-2 block",children:["Responsável ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(k,{id:"responsavel",value:l.responsavelId,onChange:r=>t("responsavelId",r.target.value),placeholder:"Nome do responsável",sizing:"sm",className:"rounded-sm",required:!0,disabled:s})]}),e.jsxs("div",{children:[e.jsxs(b,{htmlFor:"motivo",className:"text-gray-700 dark:text-gray-300 mb-2 block",children:["Motivo ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs(le,{id:"motivo",value:l.motivo,onChange:r=>t("motivo",r.target.value),sizing:"sm",className:"rounded-sm",required:!0,disabled:s,children:[e.jsx("option",{value:"",children:"Selecione o motivo"}),n().map(r=>e.jsx("option",{value:r,children:r},r))]})]}),a==="entrada"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(b,{htmlFor:"custoUnitario",className:"text-gray-700 dark:text-gray-300 mb-2 block",children:"Custo Unitário (R$)"}),e.jsx(k,{id:"custoUnitario",type:"number",step:"0.01",min:"0",value:l.custoUnitario||"",onChange:r=>t("custoUnitario",parseFloat(r.target.value)||0),placeholder:"0,00",sizing:"sm",className:"rounded-sm",disabled:s})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"notaFiscal",className:"text-gray-700 dark:text-gray-300 mb-2 block",children:"Nota Fiscal"}),e.jsx(k,{id:"notaFiscal",value:l.notaFiscal||"",onChange:r=>t("notaFiscal",r.target.value),placeholder:"Número da NF",sizing:"sm",className:"rounded-sm",disabled:s})]})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"lote",className:"text-gray-700 dark:text-gray-300 mb-2 block",children:"Lote/Série"}),e.jsx(k,{id:"lote",value:l.lote||"",onChange:r=>t("lote",r.target.value),placeholder:"Número do lote ou série",sizing:"sm",className:"rounded-sm",disabled:s})]})]}),e.jsxs("div",{children:[e.jsx(b,{htmlFor:"observacoes",className:"text-gray-700 dark:text-gray-300 mb-2 block",children:"Observações"}),e.jsx(ne,{id:"observacoes",value:l.observacoes||"",onChange:r=>t("observacoes",r.target.value),placeholder:"Observações adicionais sobre a movimentação...",rows:3,className:"rounded-sm",disabled:s})]})]})},Ee=a=>{switch(a){case"entrada":return"Nova Movimentação - Entrada";case"saida":return"Nova Movimentação - Saída";case"ajuste":return"Ajustar Quantidade de Item";default:return"Nova Movimentação"}},Le=({show:a,onClose:l,onSave:t,item:o,tipo:s,formData:n,onChange:x,getTipoEPI:c,isLoading:r=!1})=>{const d=o?c(o.tipoEPIId):null,v=async()=>{try{await t()}catch(i){console.error("Erro na movimentação:",i),alert("Erro ao executar movimentação. Tente novamente.")}},g=()=>n.quantidade>0&&n.responsavelId&&n.motivo;return e.jsxs(f,{show:a,onClose:l,size:"xl",children:[e.jsx(f.Header,{children:e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:Ee(s)})}),e.jsx(f.Body,{className:"overflow-y-auto max-h-96",children:e.jsxs("div",{className:"space-y-6",children:[s==="ajuste"&&o&&e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Item para Ajuste"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Equipamento:"}),e.jsx("p",{className:"text-gray-900 dark:text-white font-medium",children:d==null?void 0:d.nomeEquipamento})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"CA:"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:d==null?void 0:d.numeroCA})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Localização:"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:o.localizacao})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Estoque atual:"}),e.jsxs("p",{className:"text-gray-900 dark:text-white font-medium",children:[o.quantidade," unidades"]})]})]})]}),s!=="ajuste"&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 dark:text-blue-300 mb-2",children:s==="entrada"?"Nova Entrada de Estoque":"Nova Saída de Estoque"}),e.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-400",children:s==="entrada"?"Registre uma nova entrada de itens no estoque. Você pode adicionar múltiplos itens de uma vez.":"Registre uma nova saída de itens do estoque. Especifique os itens e quantidades."})]}),e.jsx(Ae,{tipo:s,formData:n,onChange:x,currentStock:(o==null?void 0:o.quantidade)||0,disabled:r})]})}),e.jsx(f.Footer,{children:e.jsxs("div",{className:"flex justify-end space-x-3 w-full",children:[e.jsx(y,{onClick:l,color:"gray",sizing:"xs",className:"rounded-sm",disabled:r,children:"Cancelar"}),e.jsx(y,{onClick:v,color:"primary",sizing:"xs",className:"rounded-sm",disabled:!g()||r,children:r?"Executando...":s==="ajuste"?"Ajustar Quantidade":`Registrar ${s==="entrada"?"Entrada":"Saída"}`})]})})]})},Te=a=>{switch(a){case"entrada":return{color:"green",label:"Entrada",symbol:"+"};case"saida":return{color:"red",label:"Saída",symbol:"-"};case"entrega":return{color:"blue",label:"Entrega",symbol:"-"};case"devolucao":return{color:"purple",label:"Devolução",symbol:"+"};case"ajuste":return{color:"yellow",label:"Ajuste",symbol:"±"};case"cadastro":return{color:"gray",label:"Cadastro",symbol:"●"};case"perda":return{color:"failure",label:"Perda",symbol:"-"};case"vencimento":return{color:"warning",label:"Vencimento",symbol:"-"};default:return{color:"gray",label:"Indefinido",symbol:"?"}}},He=({show:a,onClose:l,item:t,getTipoEPI:o})=>{const[s,n]=m.useState([]),[x,c]=m.useState(!1),[r,d]=m.useState(null);m.useEffect(()=>{a&&t&&v()},[a,t]);const v=async()=>{if(t){c(!0),d(null);try{const i=await he.getByItem(t.id);n(i.sort((j,w)=>new Date(w.data).getTime()-new Date(j.data).getTime()))}catch(i){console.error("Erro ao buscar histórico:",i),d("Erro ao carregar histórico de movimentações"),n([])}finally{c(!1)}}};if(!t)return null;const g=o(t.tipoEPIId);return e.jsxs(f,{show:a,onClose:l,size:"lg",children:[e.jsx(f.Header,{children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Histórico de Movimentações"}),e.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[g==null?void 0:g.nomeEquipamento," • CA ",g==null?void 0:g.numeroCA]})]})}),e.jsx(f.Body,{className:"overflow-y-auto max-h-96",children:x?e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary-600"}),e.jsx("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Carregando histórico..."})]}):r?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"w-12 h-12 text-red-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 16.5c-.77.833.192 2.5 1.732 2.5z"})}),e.jsx("p",{className:"text-red-600 dark:text-red-400 mb-2",children:r}),e.jsx(y,{onClick:v,color:"gray",sizing:"xs",className:"rounded-sm",children:"Tentar novamente"})]}):e.jsx("div",{className:"space-y-4",children:s.length>0?s.map(i=>{const j=Te(i.tipo);return e.jsxs("div",{className:"border border-gray-200 dark:border-gray-600 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs(_,{color:j.color,size:"sm",className:"w-fit",children:[j.symbol," ",j.label]}),e.jsx("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:Q(i.data)})]}),e.jsx("div",{className:"mb-3",children:e.jsx("p",{className:"text-sm text-gray-900 dark:text-white",children:i.descricao})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Quantidade:"}),e.jsxs("p",{className:"text-gray-900 dark:text-white font-medium",children:[j.symbol!=="●"&&j.symbol!=="±"&&j.symbol!=="?"?j.symbol:"",i.quantidade," un."]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Responsável:"}),e.jsx("p",{className:"text-gray-900 dark:text-white",children:i.responsavel})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Estoque:"}),e.jsxs("p",{className:"text-gray-900 dark:text-white",children:[i.quantidadeAnterior," → ",i.quantidadeAtual]})]})]}),i.detalhes&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100 dark:border-gray-600",children:e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400 space-y-1",children:[i.detalhes.motivo&&e.jsxs("p",{children:[e.jsx("strong",{children:"Motivo:"})," ",i.detalhes.motivo]}),i.detalhes.colaboradorNome&&e.jsxs("p",{children:[e.jsx("strong",{children:"Colaborador:"})," ",i.detalhes.colaboradorNome]})]})})]},i.id)}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("svg",{className:"w-12 h-12 text-gray-400 mx-auto mb-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhuma movimentação encontrada"}),e.jsx("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-2",children:"As movimentações aparecerão aqui conforme forem realizadas"})]})})}),e.jsx(f.Footer,{children:e.jsx("div",{className:"flex justify-end w-full",children:e.jsx(y,{onClick:l,color:"primary",sizing:"xs",className:"rounded-sm",children:"Fechar"})})})]})},O={quantidade:1,responsavelId:"",motivo:"",observacoes:""},Pe=a=>{const[l,t]=m.useState(!1),[o,s]=m.useState(!1),[n,x]=m.useState("entrada"),[c,r]=m.useState(null),[d,v]=m.useState(O),g=(h,p)=>{r(h),x(p),t(!0),i()},i=()=>{v(O)};return{showMovimentacaoModal:l,setShowMovimentacaoModal:t,showHistoricoModal:o,setShowHistoricoModal:s,tipoMovimentacao:n,setTipoMovimentacao:x,selectedItem:c,setSelectedItem:r,formData:d,setFormData:v,abrirMovimentacao:g,executarMovimentacao:async()=>{if(c)try{switch(n){case"entrada":await F.entrada(c.id,{quantidade:d.quantidade,responsavelId:d.responsavelId,motivo:d.motivo,notaFiscal:d.notaFiscal,observacoes:d.observacoes});break;case"saida":await F.saida(c.id,{quantidade:d.quantidade,responsavelId:d.responsavelId,motivo:d.motivo,observacoes:d.observacoes});break;case"ajuste":await F.ajuste(c.id,{novaQuantidade:d.quantidade,responsavelId:d.responsavelId,motivo:d.motivo,observacoes:d.observacoes});break}await a(),t(!1),i(),r(null)}catch(h){throw console.error("Erro ao executar movimentação:",h),h}},resetForm:i,handleInputChange:(h,p)=>{v(M=>({...M,[h]:p}))}}},T=10,Re=(a,l)=>{const[t,o]=m.useState(""),[s,n]=m.useState("todos"),[x,c]=m.useState("todas"),[r,d]=m.useState(1),v=ve(l),g=m.useMemo(()=>a?a.filter(h=>{const p=v(h.tipoEPIId),M=I(h),q=!t||(p==null?void 0:p.nomeEquipamento.toLowerCase().includes(t.toLowerCase()))||(p==null?void 0:p.numeroCA.toLowerCase().includes(t.toLowerCase()))||h.localizacao.toLowerCase().includes(t.toLowerCase()),z=s==="todos"||M===s,S=x==="todas"||h.localizacao===x;return q&&z&&S}):[],[a,t,s,x,v]),i=Math.ceil(g.length/T),j=g.slice((r-1)*T,r*T),w=m.useMemo(()=>a?{totalItens:a.length,totalDisponivel:a.reduce((h,p)=>h+p.quantidade,0),estoqueMinimo:a.filter(h=>I(h)==="baixo_estoque").length,proximoVencimento:a.filter(h=>I(h)==="vencido").length}:{totalItens:0,totalDisponivel:0,estoqueMinimo:0,proximoVencimento:0},[a]);return{searchTerm:t,setSearchTerm:o,filtroStatus:s,setFiltroStatus:n,filtroLocalizacao:x,setFiltroLocalizacao:c,itensFiltrados:g,paginatedItens:j,totalPages:i,currentPage:r,setCurrentPage:d,estatisticas:w,getTipoEPI:v}},Xe=()=>{const a=de(),[l,t]=m.useState(!1),{data:o,loading:s,error:n,refetch:x}=D(F.getAll),{data:c}=D(ge.getAll),{showMovimentacaoModal:r,setShowMovimentacaoModal:d,showHistoricoModal:v,setShowHistoricoModal:g,tipoMovimentacao:i,selectedItem:j,setSelectedItem:w,formData:h,abrirMovimentacao:p,executarMovimentacao:M,resetForm:q,handleInputChange:z}=Pe(x),{searchTerm:S,setSearchTerm:$,filtroStatus:U,setFiltroStatus:W,filtroLocalizacao:G,setFiltroLocalizacao:J,paginatedItens:A,totalPages:P,currentPage:E,setCurrentPage:K,estatisticas:X,getTipoEPI:L}=Re(o,c),Y=[...new Set((o==null?void 0:o.map(N=>N.localizacao))||[])],Z=N=>{p(N,"ajuste")},ee=N=>{w(N),g(!0)},ae=N=>{K(N),window.scrollTo(0,0)},se=async N=>{try{const{movimentacaoNotasAPI:C}=await ce(async()=>{const{movimentacaoNotasAPI:te}=await import("./format-G53zHD2b.js").then(re=>re.p);return{movimentacaoNotasAPI:te}},__vite__mapDeps([0,1,2]));await C.criarMovimentacao(N),await x()}catch(C){throw console.error("Erro ao criar movimentação:",C),C}};return s?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600 dark:text-gray-400",children:"Carregando estoque..."})]})}):n?e.jsx("div",{className:"max-w-4xl mx-auto mt-8 p-6",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("div",{className:"flex",children:e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Erro ao carregar estoque"}),e.jsx("div",{className:"mt-2 text-sm text-red-700",children:e.jsx("p",{children:n})}),e.jsx("div",{className:"mt-4",children:e.jsx(y,{onClick:x,color:"gray",size:"sm",children:"Tentar novamente"})})]})})})}):e.jsxs("div",{className:"bg-white dark:bg-gray-900",children:[e.jsx("div",{className:"mx-auto max-w-full",children:e.jsxs("div",{className:"bg-white dark:bg-gray-900 relative shadow-md sm:rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between space-y-3 md:space-y-0 md:space-x-4 p-4",children:[e.jsxs("div",{className:"w-full md:w-1/2",children:[e.jsx("h1",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Estoque de EPIs"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Controle movimentações e inventário de equipamentos de proteção"})]}),e.jsxs("div",{className:"w-full md:w-auto flex flex-col md:flex-row space-y-2 md:space-y-0 items-stretch md:items-center justify-end md:space-x-3 flex-shrink-0",children:[e.jsxs(y,{onClick:()=>t(!0),color:"primary",sizing:"xs",className:"rounded-sm",children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Nova Movimentação"]}),e.jsxs(y,{onClick:()=>a("/movimentacoes"),color:"gray",sizing:"xs",className:"rounded-sm",children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"Ver Movimentações"]}),e.jsx(R,{label:"",dismissOnClick:!1,renderTrigger:()=>e.jsx(y,{color:"light",sizing:"xs",className:"rounded-sm",children:e.jsx(xe,{className:"w-4 h-4"})}),children:e.jsx(R.Item,{icon:ye,children:"Exportar relatório"})})]})]}),e.jsx(ke,{stats:X}),e.jsx(Ce,{searchTerm:S,setSearchTerm:$,filtroStatus:U,setFiltroStatus:W,filtroLocalizacao:G,setFiltroLocalizacao:J,localizacoes:Y}),e.jsx(Fe,{itens:A,getTipoEPI:L,onAjuste:Z,onHistorico:ee}),P>1&&e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center space-y-3 md:space-y-0 p-4",children:[e.jsxs("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:["Mostrando ",e.jsxs("span",{className:"font-semibold text-gray-900 dark:text-white",children:[(E-1)*10+1,"-",Math.min(E*10,A.length)]})," de ",e.jsx("span",{className:"font-semibold text-gray-900 dark:text-white",children:A.length})]}),e.jsx(ie,{currentPage:E,totalPages:P,onPageChange:ae,showIcons:!0})]})]})}),e.jsx(Le,{show:r,onClose:()=>{d(!1),q()},onSave:M,item:j,tipo:i,formData:h,onChange:z,getTipoEPI:L}),e.jsx(je,{show:l,onClose:()=>t(!1),onSave:se,tiposEPI:c||[],estoque:o||[],isLoading:s}),e.jsx(He,{show:v,onClose:()=>{g(!1),w(null)},item:j,getTipoEPI:L})]})};export{Xe as default};
//# sourceMappingURL=EstoqueEPIs-BekCip_6.js.map
